# 3장. 역할, 책임, 협력
객체지향의 본질
- 객체들의 공동체를 창조하는 것
- 협력을 구성하기 위해 적절한 객체를 찾고 책임을 할당하는 과정이 중요하다

## 01. 협력
### 협력
메시지 전송
- 두객체 사이의 협력은 하나의 객체가 다른 객체에게 도움을 요청할 때 시작된다
- 메시지전송은 객체 사이의 협력을 위해 사용할 수 있는 유일한 커뮤니케이션 수단
- 객체는 다른 객의 상세한 내부 구현에 직접 접근할 수 없기 때문에 오직 메시지 전송을 통해서만 자신의 요청을 전달할 수 있다

Screening과 Movie의 협력
- 협력 관계: ':Screening' -> 'calculateMovieFee(screening)' -> ':Movie'
- Screening이 Movie에게 처리를 위임하는 이유는 요금을 계산하는데 필요한 기본 요금과 할인 정책을 가장 잘 알고 있는 객체가 Movie이기 때문이다
- 이를 위해서는 Movie가 자율적인 존재가 되어야 한다
- 그리고 Movie가 자율적이 되기 위해서 가장 기본적인 방법은 내부 구현을 캡슐화하는 것이다

자율적인 객체
- 자율적인 객체는 자신에게 할당된 책임을 수행하던 중에 필요한 정보를 알지 못하거나 외부의 도움이 필요한 경우 적절한 객체에게 메시지를 전송해서 협력을 요청한다
- 메시지를 수신한 객체 역시 메시지를 처리하는 중에 직접 처리할 수 없거나 자신이 정보를 모르면 또 다른 객체에게 도음을 요청한다

### 협력이 설계를 위한 문맥을 결정한다
객체의 존재
- 객체는 상태와 행동을 함께 캡슐화하는 실행단위다
- 객체의 상태와 행동은 객체가 참여하고 있는 협력에 의해서 결정된다
- Movie의 경우는 영화 예매를 위한 협력이다
- 협력이라는 문맥을 고려하지 않고 Movie의 행동을 결정하는 것은 아무 의미가 없다. 협력이 존재하기 때문에 객체가 존재하는 것이다

## 02. 책임
### 책임이란
책임
- 협력에 참여하기 위해 객체가 수행하는 행동을 협력이라고 부른다
- 객체지향 설계에서 가장 중요한 것
- 객체의 책임은 객체가 '무엇을 알고 있는가?'와 '무엇을 할 수 있는가'로 구성된다
   - 아는 것
      - 사적인 정보에 관해 아는 것
      - 관련된 객체에 대해 아는 것
      - 자신이 유도하거나 계산할 수 있는 것에 관해 아는 것
   - 하는 것
      - 객체를 생성하거나 계산을 수행하는 등의 스스로 하는 것
      - 다른 객체의 행동을 시작하는 것
      - 다른 객체의 활동을 제어하고 조절하는 것
- _협력을 객체 사이의 관계라고 한다면, 책임은 협력을 수행하기 위해 하는 행동_

### 책임 할당
정보 전문가 패턴
- 자율적인 객체를 만드는 가장 기본적인 방법
- 책임을 수행하는데 필요한 정보를 가장 잘 알고 있는 전문가에게 그 책임을 할당하는 것

협력을 설계하면서 객체의 책임을 식별해 나가는 과정에서 최종적으로 얻게 되는 결과물은 시스템을 구성하는 객체들의 인터페이스와 오퍼레이션의 목록이다

### 책임 주도 설계
책임 주도 설계 (RDD)
- 어떤 책임을 선택하느냐가 전체적인 설계의 방향과 흐름을 결정한다
- 책임을 찾고 책임을 수행할 적절한 객체를 찾아 책임을 할당하는 방식

### 메시지가 객체를 결정한다
Screening과 Movie의 예시를 보면, 
1. '예매하라' 는 메시지를 정하고
2. 'Screening' 객체를 선택한다

### 행동이 상태를 결정한다
객체지향 패러다임에 갓 입문한 사람들이 가장 쉽게 빠지는 실수는 객체의 행동이 아니라 상태에 초점을 맞추는 것이다. 초보자들은 먼저 필요한 상태가 무엇인지 결정하고, 그 후에 상태에 필요한 행동을 결정한다. 

협력 관계 속에서 다른 객체에게 무엇을 제공해야 하고 다른 객체로부터 무엇을 얻어야 하는지를 고민해야만 훌륭한 책임을 수확할 수 있다. 

## 역할
### 역할과 협력
역할
- 객체가 특정한 협력 안에서 수행하는 책임의 집합을 역할이라고 부른다 (역할은 다른 것으로 교체될 수 있는 책임의 집합이다)
- 아래 그림에서 중요한 것은 역할이 두 종류의 구체적인 객체를 포괄하는 추상화라는 점이다
![3-2](/Images/오브젝트/3-1.png)
- 요점은 동일한 책임을 수행하는 역할을 기반으로 두 개의 협력을 하나로 통합할 수 있다는 것
- 역할을 구현하는 가장 일반적인 방법은 추상 클래스와 인터페이스를 사용하는 것이다

### 객체 대 역할
협력에 참여하는 후보가 여러 종류의 객체에 의해 수행될 필요가 있다면 그 후보는 역할이 되지만, 단지 한 종류의 객체만이 협력에 참여할 필요가 있다면 후보는 객체가 된다
- _여러 구체적인 객체를 포괄하는 기능이 필요하다면 인터페이스로 구현하지만, 그게 아니라면 구체적인 클래스를 사용하라는 것 아닐까?_

설계 초반에는 적절한 책임과 협력의 큰 그림을 탐색하는 것이 가장 중요한 목표여야 하고, 역할과 객체를 명확하게 구분하는 것은 그렇게 중요하지 않다. 따라서 애매하다면 단순하게 객체로 시작하고 반복적으로 책임화 협력을 정제해가면서 필요한 순간에 객체로부터 역할을 분리해내는 것이 가장 좋은 방법이다. 

협력, 역할, 객체, 클래스의 관계
- 협력 (reference) 역할 (select from) 객체 (instance of) 클래스

### 역할과 추상화
추상화를 이용한 설계의 정잠
1. 추상화 계층만을 이용하면 중요한 정책을 상위 수준에서 단순화 할 수 있다
2. 설계가 유연해 진다

협력이라는 관점에서는 세부적인 사항을 무시하고 추상화에 집중하는 것이 우용하다

### 배우와 배역
배역은 역할이고, 배우는 객체다
- 연극안에서 배역을 연기하는 배우라는 은유는 협력 안에서 역할을 수행하는 객체다
- 동일한 객체라고 하더라도 객체가 참여하는 협력에 따라 객체의 얼굴은 계속 바뀐다