# 01. 도메인 모델 시작하기
## 도메인이란
도메인은 소프트웨어로 해결하고자하는 문제의 영역. 
- 예: 온라인서점, 라스트마일

한 도메인은 다시 하위 도메인으로 나뉠 수 있다
- 예시
   ![1-2](/%EA%B8%B0%EC%88%A0%EC%84%9C%EC%A0%81/%5B%EA%B8%B0%EB%B3%B8%5D%20DDDStart/2%EC%B0%A8/image/1-2.jpg)
   - 카탈로그 도메인: 고객에게 구매할 수 있는 상품 목록을 제공
   - 주문 도메인: 고객의 주문을 처리
   - 혜택 도메인: 쿠폰이나 특별 할인 같은 서비스 제공
- 예: 라스트마일: 배송, 기사, 지점, 오더, 정산 등등

도메인의 구현은 모든 기능을 직접 구현할 필요는 없다
- 직접 구현
- 잘 만들어진 라이브러리 또는 외부 시스템
- 외부 업체에 구현 의뢰

## 도메인 전문가와 개발 간 지식 공유
각 영역에는 전문가가 있다. 전문가는 해당 도메인에 대한 지식과 경험을 바탕으로 본인들이 원하는 기능 개발을 요구한다
- 예: 회계 담당자 -> 정산 자동화, AS 기사 -> 문자를 빠르게 보내기 위한 템플릿
- 부릉 예: 라스트마일 운영실, 고객 지원팀, 기사, 지점, 상점 등 

개발자는 이런 요구사항을 분석하고 설계해서 코드를 작성하고 테스트하고 배포해야한다. 
- 잘 설계하기 위해서는 요구사항을 잘 분석하는게 중요하다
- 요구사항을 올바르게 이해하려면 개발자와 전문가가 직접 대화하는 방법이 있다. 이 과정에서 개발자도 도메인 지식을 갖춰야한다. 
- _개발자의 지식 자랑이 아니라, 우리는 결국 문제를 해결해야한다._

## 도메인 모델
도메인 모델이란?
- 특정 도메인을 개념적으로 표현한 것. (다양한 정의가 존재하는데, 이 책에서는 이렇게 표현)
- 도메인모델을 사용하면 여러 관계자들이 동일한 모습으로 도메인을 이해하고 지식을 공유하는데 도움이 된다

객체 도메인 모델
- 도메인이 제공하는 기능과 데이터를 함께 보여주는 모델
- 예시
   ![1-3](/%EA%B8%B0%EC%88%A0%EC%84%9C%EC%A0%81/%5B%EA%B8%B0%EB%B3%B8%5D%20DDDStart/2%EC%B0%A8/image/1-3.jpg)

상태 다이어그램
- 상태 전이를 표현. 상태의 변경이나 연관관계를 이해하는데 도움이 된다
- 예시
   ![1-4](/%EA%B8%B0%EC%88%A0%EC%84%9C%EC%A0%81/%5B%EA%B8%B0%EB%B3%B8%5D%20DDDStart/2%EC%B0%A8/image/1-4.jpg)

도메인 모델을 표현하는 방법은 다양하다
- 관계가 중요한 도메인이라면 그래프를 이용해서 모델링 할 수도 있고, 계산 규칙이 중요하다면 수학공식을 활용해서 모델을 만들 수도 있다
- 도메인을 이해하는데 도움이 되면 포현 방식은 중요하지 않다

개념 모델과 구현 모델
- 도메인 모델은 도메인 자체를 이해하기 위한 개념 모델이다
- 개념 모델을 이용해서 코드를 바로 작성할 수 있는것은 아니기 때문에 구현 기술에 맞는 구현 모델이 따로 필요하다

하위 도메인과 모델
- 도메인은 다수의 하위 도메인으로 구성된다
- 각 하위 도메인이 다루는 영역이 서로 다르기 때문에 같은 용어라도 하위 도메인마다 의미가 달라질 수 있다

## 도메인 모델 패턴
도메인 모델 패턴
- 도메인 모델과 각 모델간의 관계를 이용해서 문제를 해결하려는 패턴 (객체 지향과 유사)
- 반대되는 패턴: 트랜잭션 스크립트 패턴

일반적인 애플리케이션 아텍텍처 구성
- 구성
   ```
   //////////////////////
   Presentation
   //////////////////////
   Application
   //////////////////////
   Domain
   //////////////////////
   Infrastructure
   //////////////////////
   ```
   - Presentation: 사용자의 요청을 처리하고 사용자에게 정보를 보여준다. 사용자는 소프트웨어를 사용하는 사람이 될 수 도 있고, 외부 시스템이 될 수도 있다
   - Application: 사용자가 요청한 기능을 실행한다. __비지니스 로직을 직접 구현하지 않고, 도메인 계층을 조합해서 기능을 실행한다.__
   - Domain: 비지니스 로직을 구현한다
   - Infrastructure: 데이터베이스나 메시징 시스템같은 외부 시스템과의 연동을 처리한다

주문 도메인 예시
- 규칙
   - 출고 전에 배송지를 변경할 수 있다
- 코드
   ```java
   public class Order {

    public void changeShippingInfo(ShippingInfo newShippingInfo) {
        // '출고전에 배송지를 변경할 수 있다'라는 규칙으 체크하기 위한 로직이 들어간다
        if (!isShippingChnageable()) {
            throw new IllegalStateException("...");
        }

        this.shippingInfo = newShippingInfo;
    }
   }
   ```
- 중요한것은 이런 비지니스 로직이 주문 도메인 모델에 있어야한다는 것이다


