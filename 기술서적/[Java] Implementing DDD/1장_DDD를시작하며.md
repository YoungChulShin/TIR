## 나도 DDD를 할 수 있을까
도메인 전문가란
- 도메인 전문가는 단순한 직책이 아니다. 이들은 당신이 일하고 있는 비지니스의 과정을 아주 잘 알고 있는 사람들이다.

당신의 도메인은 무엇인가?
- 당신이 일하고 있는 아주 구체적인 비니지스 도메인에 관한 소프트웨어 모델이다. 객체 모델로 종종 구현되는데, 이런 객체는 비지니스의 의미에 정확히 부합하는 이름을 가진 데이터와 행동을 담고 있다. 

## 내가 왜 DDD를 해야 할까
DDD가 실제적으로 괜찮은지에 대한 근거
- 도메인 전문가와 개발자들의 눈옾이를 맞춰줌으로써, 코더에게뿐 아니라 비지니스 관계자에도 말이되는 소프트웨어를 만들게 한다. 
- 도메인 전문가와 소프트웨어 개발자 그리고 소프트웨어 사이에 전혀 번역이 필요하지 않다. 팀원 모두가 쓸 줄 아는 공통의 언어를 사용해 당신의 팀이 개발하게 되기 때문이다. 

### 비지니스 가치를 제공하는 것은 어려울 수 있다
일반적인 비즈니스 소프웨어의 개발은 진정한 비즈니스 가치를 제공하는 소프트웨어의 개발과는 분명히 다르다. 진정으로 가치를 제공하는 소프트웨어는 전략적 비즈니스 발의와 뜻을 같이 하며 분명히 식별 가능한 경쟁력이 있는 이점, 즉 기술에 관한 것이 아닌 __비즈니스에 관한 솔루션을__ 제공한다

일반적으로, 진정한 도메인 전문가는 비즈니스 가치를 제공하는 데 집중한다. 한편, 소프트웨어 개발자는 전형적으로 기술과 비즈니스의 문제점의 기술적 해결에 더 관심을 갖는다. 

이보다 더한 문제는 소프트웨어 개발의 기술적 접근이 사실상 비즈니스 기능을 잘못된 방향으로 변경할 때다. ERP는 종종 조직의 비즈니스 기능 전반을 ERP 기능에 맞춰서 변경하게 한다.

### DDD까 해줄 수 있는 일
DDD는 다음 세가지 중요한 측면에 집중한 소프트웨어 개발 접근법이다
1. DDD는 도메인 전문가와 소프트웨어 개발자가 비즈니스 전문가의 심적 모델을 반영한 소프트웨어를 함께 개발할 수 있게 해준다
2. DDD는 비즈니스의 전략적 이니셔티브(Initiative)를 다룬다. 전략적 설계의 기술적 측면은 시스템과 비즈니스의 문제를 명확하게 결합하는 데 목표가 있으며, 이는 각 비즈니스 단계의 서비스를 보호한다. 이는 서비스 지향 아키텍처(SOA)나 비즈니스 주도 아키텍처(BDA)를 어떻게 성공시킬지의 측면에서 의미 있는 동기를 부여한다.
3. 전술적 설계 도구는 도메인 전문가의 심적 모델이 올바르게 코드화 되고, 테스트 가능성이 높고, 오류가 적고, 서비스 수준 계약을 수행하고, 확장 가능하고, 분산 컴퓨팅이 가능한 소프트웨어를 만들도록 한다. 

### 무기력증과 기억상실
도메인 모델의 병력 진단서
- _물음에 대해서 둘다 '예'라고 대답_

애너믹 도메인 모델은 도메인 모델이 전혀 아니며, 단순한 관계형 모델로부터 객체로 투영된 데이터 모델일 뿐이란 말을 덧붙이고 싶다. 

### 왜 무기력증이 일어나는가
1. 과도하게 단순화된 샘플 코드에는 많은 수의 게터와 세터가 나타나기 마련인데, 이런 코드가 설꼐를 다시 살표보지 않은 상태로 매일같이 단순히 그대로 복사해 사용되고 있다
2. VB으로 출발한 Getter와 Setter의 노출이 자바와 하이버네이트까지 내려오면서, 풍부한 행동 인터페이스를 가진 POJO를 설계할 때도, 내부를 공개적으로 노출시켜 하이버네이트가 당신의 도메인 객체를 저장하고 재구축할 수 있도록 해야 했다.

오늘날 시장의 거의 모든 프레임워크는 단순한 객체에 퍼블릭 속성을 사용하길 요구하는 동시에 권장하고 있다. 대부분의 개발자가 엔터프라이즈 전반에 걸쳐 있는 모든 애너믹 클래스에 영향을 받을 수 밖에 없다. 

### 무기력증에 대한 코드 예시
설계를 구현으로 부터 구분하려고 하지 말아보라. DDD를 수행할 때, 설계는 코드이며 즉 코드는 설계다. 즉, 칠판에 그려진 다이어그램은 설계가 아니고, 단지 모델의 어려운 부분을 논의하는 한 방법일 뿐이다. 


## DDD는 어떻게 하는가
### 유비쿼터스 언어
정의
- 유비쿼터스 언어는 팀 내에 공유된 언어다. 그것은 도메인 전문가와 개발자 간에 같이 공유된다. 그리고 실제론 해당 프로젝트에 참여하는 모든 사람간에 공유된다. 팀에서 당신의 역할이 무엇이든, 단순히 이 프로젝트에 참여하고 있다는 이유만으로 이 유비쿼터스 언어를 사용하게 된다. 
- 도메인 전문가와 소프트웨어 개발자 모두에 의해 개발되어 공유된 언어

어떻게 담아내야 할까?
- 물리적이고 개념적인 도메인 그림을 그리고 이름과 행동을 붙여보라
- 간단한 정의로 구성된 용어집을 만들다
- 용어집을 만드는게 마음에 들지 않는다고 해도, 형식에 얽메이지 말고 소프트웨어의 중요한 개념을 담은 그림을 넣어서 문서의 형태로 남기자
- 만들어진 구문을 나머지 팀원들과 돌려보며 리뷰하자

이를 바탕으로 한 샘플 코드의 수정
- before
   - `Service`에서 1개의 메서드가 모든 기능을 처리
   - `Domain`은 데이터 저장만 담당
- after
   - `Domain`에서 행동 구현
   - `Service`에서는 개별 메서드 구현
- 테스트와의 연관성
   - 이를 테스트해서, 정확히 원하는 것을 수행하고 수행하지 말아야 할 일을 하지 않는다는 결과를 확인할 수 있다

바운디드 컨텍스트
- 제대로 DDD를 사용하는 새로운 프로젝트를 시작한다면, 개발하고 있는 격리된 바운디드 컨텍스트를 밝혀내라. 이렇게 함으로써 당신의 도메인 모델 주변에 명시적인 경계를 그을 수 있다. 명시적으로 바운디드 컨텍스트 내의 격리된 도메인 모델에서 유비쿼터스 언어를 토론하고, 연구하고, 개념화하고, 개발하고, 사용하라.
- 여러분의 격리된 컨텍스트상에서 합의된 유비쿼터스 언어가 아닌 모든 개념을 거부하라. 

## DDD를 사용하는 데서 오는 비즈니스 가치
1. 조직이 그 도메인에 유용한 모델을 얻는다
   - 과도한 모델링을 하지 않으며 핵심 도메인에 초점을 맞춘다
2. 정교하고 정확하게 비즈니스를 정의하고 이해한다
3. 도메인 전문가가 소프트웨어 설계에 기여한다
   - 개발자는 이제 도메인 전문가와 하나된 팀으로 공통의 언어를 공유한다
   - 선택된 소수만이 모델을 이해하게 되는 경우가 줄어든다
   - 이런 지식은 필요로하는 조직 내 누구에게나 열려 있으며, 전문가와 그 외의 개발자와 새로운 사람들은 지속적으로 공통 지식을 공유하게 된다
4. 사용자 경험이 개선된다
   - 사용자 경험이 근간을 이루는 전문가 모델의 윤곽을 따라 설계돼야, 사용자가 올바른 결론을 내리도록 이끌 수 있다
5. 순수한 모델 주변에 명확한 경계가 생긴다
6. 엔터프라이즈 아키텍쳐의 구성이 좋아진다
7. 애자일하고, 반복적이고, 지속적인 모델링이 사용된다
   - DDD는 도메인 전문가의 심적 모델을 신중히 정제해서 비즈니스에 유용한 모델로 만드는 방법에 관한 문제다. 
   - 팀의 노력은 애자일 접근법을 따라 투입되는데, 이는 반복적이고 점진적인 것이다. 팀이 익숙한 애자일 프로세스라면 모두가 DDD에서 성공적으로 사용될 수 있다. 만들어진 모델은 결국 동작하는 소프트웨어다. 이는 비즈니스에 더 이상 필요하지 않을 때까지 계속해서 정제된다.
8. 전략적인 동시에 전술적인 새로운 도구가 적용된다

## DDD 적용의 난관
일반적인 문제점
- 유비쿼터스 언어를 만드는 데 드는 시간과 노력을 계산하는 것
   - DDD를 사용할 때 가장 어려운 점 중 하나는 비즈니스 도메인에 관해 고민하고 개념과 용어를 연구하고 유비쿼터스 언어를 발견 및 포착하고 개선하기 위해 도메인 전문가와 대화하는 데 드는 시간과 노력이며, 기술적인 코딩에 필요한 시간이나 노력이 아니다. 
- 도메인 전문가를 시작부터 참여시키고 프로젝트 내내 함께하는 것
   - 개발자는 진정한 전문가와 대화하며 주의 깊게 귀를 기울여, 그들이 이야기하는 언어를 소프트웨어로 녹여냄으로써 도메인에 대한 전문가의 심적 모델을 반영해야 한다.
- 도메인 내의 해결책에 관한 개발자의 사고 방식을 바꾸는 것
   - 오랫동안 기술적인 방법으로 소프트웨어 개발을 진행하는 게 습관이 됐다면, 아마도 이제는 새로운 사고 방식을 가져보는 것도 좋겠다.
   - 우리가 소프트웨어를 통해 도메인을 모델링할 때, 우리는 어떤 모델 객체가 무엇을 수행할지 신중히 고려해야 한다. 이는 객체의 행동을 설계한다는 의미다. 우리가 유비쿼터스 언어의 핵심을 전달할 수 있도록 행동에 이름을 붙여야 한다는 말에는 동의한다. 그러나 행동에 따라 객체가 무엇을 할지 고려해야만 한다. 이는 클래스에 속성을 만들고 게터와 세터를 모델의 클라이언터에게 공개하는 노력보다 높은 수준의 노력이 필요하다. 


BacklogItem 샘플 코드 (p.84)
- Before Code
   - 기존코드에서 `setSprintID`와 `setStatus`가 행동이라고 주장한다 해도, 이 행동은 실제적인 비즈니스 도메인의 가치가 하나도 없다는 데 문제가 있다.
- After Code
   - 도메인 전문가의 모델의 요구사항에 대해서 행동 중심으로 구현되어 있다.
   - 클라이언트가 간단하든지 복잡하든지 간에 커밋을 수행하기 위해 무엇인 필요한지 알 필요가 없다.

### DDD는 무겁지 않다
DDD 설계 원칙
- 제대로 DDD를 실행한다고 해서 수많은 절차와 이를 지원할 복잡한 문서 산출물 때문에 프로세스가 무거워진다는 의미는 아니다. 
- 이 설계 원칙은 오히려 테스트 우선 방식에 따라 실제 소프트웨어 모델을 빠르게 정제해나가는 방식에 더 가깝다. 여러분이 엔터티나 값 객체와 같은 새로운 도메인 객체의 개발이 필요한 상황이라면, 테스트 우선의 접근법은 다음과 같이 작동한다. 
   1. 도메인 모델의 클라이언트가 새로운 도메인 객체를 사용하는 방법을 보여주는 테스트를 작성하라
   2. 새로운 도메인 객체를 만들 때는 테스트를 컴파일 할 수 있을 정도로 충분한 코드를 함께 작성하라
   3. 테스트가 클라이언트가 도메인 객체를 사용하는 방법을 제대로 나타내고, 도메인 객체가 올바른 행동적 메서드 시그니처를 갖게 될 때까지 리팩토링 하라
   4. 테스트가 성공할 때까지 각 도메인 객체의 행동을 구현하고, 부적절한 코드의 중복이 없어질 때까지 도메인 객체를 리팩토링하라
   5. 유비쿼터스 언어의 현재 의미에 맞는 도메인 객체를 사용해 테스트하는지 확인할 수 있도록, 도메인 전문가를 포함한 팀원에게 코드를 시연하라

새로운 도메인 객체의 정확확성 검증
- 클라이언트와 유사한 모습의 잘 표현된 테스트 코드를 읽어가면 유비쿼터스 언어를 사용하는 올바른 표현 방식을 확인할 수 있다. 기술을 잘 모르는 도메인 전문가더라도 개발자의 도움과 함께 코드를 읽어간다면, 모델이 팀의 목표를 잘 달성했다는 분명한 느낌을 받을 수 있어야 한다.<br>
이는 현실적이고 원하는 수준의 표현력을 잘 살린 테스트 데이터를 준비해야 한다는 의미며, 이를 준비하지 못한다면 도메인 전문가가 구현에 관해 완벽한 판단을 내릴 수 없다. 

### 소설과 한 바구니의 현실
DDD 라이트
- DDD 라이트는 DDD 전술적 패턴의 하위 집합을 뽑아서 선택하는 방법이지만 유비쿼터스 언어를 발견하고 선정해서 발전시키는 데 모든 노력을 기울이진 않는다.
- 일반적으로 바운디드 컨텍스트와 컨텍스트 매핑을 무시하고, 보다 더 기술적인 문제에 초점을 맞춰 해결하려 노력한다.

---
## 소감
- 진정한 전문가란? 도메인 전문가란? 어떻게 찾아야 할까
- 도메인 모델의 병력 진단서를 통해서 고민하고 있던 도메인 구조에 대해서 변경의 의지가 생겼다
   - 요즘 클라이언트 영역에서 도메인 구성에 대해서 고민이 많다
   - 현재는 서버와의 DTO가 도메인 클래스의 역할을 하고 있는데, 이 부분이 맞지 않다는 것 같다는 생각을 가지고 있다.
   - 이 스터디가 그 답을 찾아가는 시간이 되었으면 좋겠다
- 책 중간에 `'어떻게 테스트할 것인지'`에 대한 이야기가 나오는데 이 부분은 요즘도 느끼고 있는 상당히 중요한 부분이다. 
   - 우리는 최근에 테스트 코드에 대해서 내부적으로 공유하고 적용해보는 시간을 가지고 있다. 그 과정에서 ViewModel에서 사용되는 일반적인 코드들이 ViewModel을 테스트하는데 어려움이 있는 구조라는 것을 알았다. 
   - 모델을 설계하면서 테스트 가능성을 염두해두고 설계하는 것이 필요한 것 같다. 서버 기준이 될 수도 있지만 테스트 함수의 역할을 결국 클라이언트에서 사용한다는 측면으로 이용될 수 있다.