# 2장 유비쿼터스 언어
1장 돌아보기
- 우리가 소프트웨어를 개발하는 것은 어떤 문제를 해결하기 위함이라는 것을 잊지 말아야한다
- 도메인: 우리가 풀어야하는 문제의 영역
- 도메인 모델: 도메인 지식을 추상화하고 조직화 한 것
- 도메인 모델은 도메인 전문가와 소프트웨어 개발자가 지속적인 대화를 통해서 만들고 고도화해야한다

의사소통의 장벽
- 도메인 모델을 만들기위해서는 소프트웨어 전문가와 도메인 전문가가 함께 만들어가야 하는데, 이러한 접근에는 의사소통 장벽으로 인한 근본적 어려움이 있다
- 개발자: 코드, 알고리즘, 객체지향 등의 용어가 익숙하고 자연스럽다
- 도메인 전문가: 자신의 특화된 분야에 대해서만 전문가
   - 1장의 항공관제시스템 구축 예를 보면, 도메인 전문가는 비행기, 경로, 고도, 위도 및 경도의 정보를 알고 있지만 이러한 것들을 외부인들은 이해하기 어려운 자신들만의 전문용어로 이야기한다. 

도메인 모델을 만들 때는 서로간의 정보를 교환해야하는데, 이 수준에서 이루어지는 의사소통이 프로젝트가 성공하는 데 가장 중요하다.
- 공통된 언어가 없다면 도메인 전문가는 자신들의 전문 용어를 사용하고, 기술팀 멤버는 설계의 관점에서 도메인을 논의하기 위한 __그들만의 언어__ 를 사용한다.
- 자연스럽게 말할때와 쓸 때 서로 다른 용어를 사용하게 된다. 결과적으로 도메인에 가장 예리한 표현(_=도메인을 표현할 수 있는 중요한 용어라고 생각하자_)은 일시적인 형태로만 나타나고, 코드나 산출물에서는 찾아볼 수 없게 된다. 
- DDD Redbook에 있는 모델 분석 - 유비쿼터스 언어 (p.74)
   - 예: 독감 백신을 어떻게 투여할 것인가?
   - case 1: "그냥 코딩해버리자. 누가 신경을 써?" -> 음..망했군
      ```java
      patient.setShotType(ShotType.TYPE_FLU);
      patient.setDose(dose); // 복용양
      patient.setNurse(nurse);
      ```
   - case 2: "환자에게 독감 주사를 놓는다" -> 조금 더 낫긴하지만 중요한 개념을 놓치고 있다
      ```java
      patient.giveFlueShot();
      ```
   - case 3: "간호사가 환자에게 정량의 독감 백신을 투여한다" -> 적어도 더 배우기 전까지는 이 문장정도로 일단 해보자.
      ```java
      Vaccine vaccine = vaccines.standardAdultFluDose();
      nurse.administerFlueVaccine(patient, vaccine);
      ```

그래서 우리는 모델을 이야기하고 정의할 때 __같은 언어__ 로 말할 필요가 있다. 

그럼 어떤 언어가 되어야할까?
- __도메인 주도 설계의 핵심 원칙은 모델 기반의 언어를 사용하는 것이다.__
- 모델은 소프트웨어와 도메인이 서로 교차하는 지점이기 때문에 모델 기반의 언어를 사용하는 것이 가장 적절하다. 
- 모델을 언어의 중추로 사용하자. 
   - 팀에서 이루어지는 모든 의사소통 순간과 코드에서도 이 언어를 최대한 끊임없이 사용하도록 요구하자.
- 이러한 언어를 `유비쿼터스 언어`라고 부른다. 
   >바운디드 컨텍스트와 유비쿼터스 언어는 DDD의 강점을 받치는 두 기둥을 이룬다. 두 기둥 없이는 온전히 설 수 없다. 
```
유비쿼터스 언어가 모델에 투영되어야 한다는 뜻이겠지..?
```

우리는 도메인과 설계를 정의할 핵심 개념을 찾아 거기에 해당하는 적절한 단어를 찾고 사용할 필요가 있다. 
- 모델과 언어는 서로 매우 긴밀하게 관련되어 있어서, 언어가 바뀌면 모델도 바뀌게 되어 있다.
- 이 과정에서
   - 도메인 전문가는 어색하거나 오해를 일으키는 용어 및 구조에 반대해야한다. 도메인 전문가가 모델이나 언어의 어떤 부분을 이해할 수 없다면 그 부분을 잘못되었을 확률이 매우 높다
   - 개발자는 설계에서 나타날 수 있는 모호함이나 불일치함을 늘 검토해야한다


## 유비쿼터스 언어 만들기
유비쿼터스 언어를 만들때는 어디서부터 시작해야할까?
- 대화로부터 시작한다
- 대화는 주요 단어를 사용해서 점진적으로 모델을 만들어간다.
   - 개발자는 개발자만의 용어를 최대한 자제하면서, 유비쿼터스 언어를 사용해야한다. 

항공 관제 예시
- https://drive.google.com/file/d/1j7v1FvvNHxyP9jyAK0FkurymoDa6qfbP/view?usp=sharing
```
책의 대화를 직접 시나리오처럼 해볼까..
```

개발자들에게는 모델의 주요 개념을 코드로 구현해보기를 강력히 권장한다.
- 모델 개념들을 그에 대응하는 클래스로 만들어봄으로써 모델과 코드, 언어와 코드를 매핑해간다. 

유비쿼터스 언어는 어디에 써야할까? 말하는곳에만 사용하면 되는걸까?
- 의사소통에 사용해야한다
- 다이어그램에 텍스트로도 사용될 수 있다
   - 어떤 사람들은 UML만으로 모델을 만들기에 충분하다고 한다. 하지만 UML은 작은 규모의 프로젝트에서는 그 자체만으로 의미를 전달하기 쉽지만, 규모가 커지만 도메인 전문가나 소프트웨어 전문가도 읽기 어렵게 된다. 
   - 그리고 UML은 클래스와 내부 속성 및 그 사이의 관계를 표현하는데에는 적합하지만, 클래스의 행동이나 제약사항을 표현하기는 쉽지 않다. 
   - 이러한 UML에 텍스트를 추가해서 도메인의 중요한 점들을 설명해준다.
- 문서에도 사용될 수 있지만, 긴 문서는 주의해야한다.
   - 문서는 모델과 동일한 내용이어야하는데, 잘못된 언어를 사용하고 모델을 반영하지 못하는 오래된 문서는 전혀 소용이 없다. 
- 코드를 가지고 의사소통 하는 것도 가능하다. 
   - 훌륭하게 쓰인 코드는 전달력이 높다. 
- ddd redbook p.75
   - 어떻게 유비쿼터스 언어를 담아내야할까?
      - 물리적이고 개념적인 도메인 그림을 그리고 이름과 행동을 붙여보라
      - 간단한 정의로 구성된 용어집을 만들라
         - 구문이 포함되는데, 구문이 뭘까? -> _간호사가 환자에게 정량의 독감 백신을 투여한다?_
      - 용어집을 만드는게 마음에 안든다면, 형식에 얽매이지 말고 소프트웨어의 중요한 개념을 담은 그림을 넣어서 문서의 형태로 남기자.
         - 여기서의 목표는 추가적인 용어와 구문을 언어로 끄집어내는데 있다. 
      - 만들어진 용어집은 팀원들과 돌려보며 리뷰하자. 
   - 하지만 문서와 그림은 시간이 지남에 따라 유비쿼터스 언어가 확장되고 변한다는 점을 언급하지는 않는다. 그래서 시간이 지나면서 점차 쓸모없어질 가능성이 매우 크다. 
   - 결국엔 팀원간의 이야기와 코드상의 모델이 가장 지속적으로 유지되고 유일하게 보장되는 유비쿼터스 언어의 모습이다.
   > 팀원 간의 이야기와 코드가 유비쿼터스 언어의 영속적인 발현이기 때문에, 이야기 속의 유비쿼터스 언어와 소스 코드가 빠르게 발전함에 맞춰서 유지하기가 어렵다면, 언제든 그림과 용어집과 그 밖의 다른 문서를 버릴 준비를 하라. DDD를 사용하는데 있어서 필수 요소는 아니지만, 모든 문서를 시스템과 동기화하는 것은 현실적으로 어렵기 때문에 이렇게 하는 편이 실용적이다. 
   ```
   그럼 결국 개발 과정에서 많은 대화를 통해서 1차적인 유비쿼터스 언어를 만들어내고, 우리는 자연스럽게 그 용어로 대화하고, 그 용어가 코드에 녹아들면 되는거구나
   ```
   

명백한 것은 소프트웨어 아키텍트, 개발자, 도메인 전문가로 구성된 설계팀은 자신들의 행동을 통합하고, 모델 작성과 작성된 모델의 코드화를 도와줄 언어가 필요하다는 점이다. 


```
우리는 결국 개발할 때 동료 개발자 또는 PO와 일하는데, 유비쿼터 언어를 어떻게 뽑아내야할까?
- 우리는 아키텍트는 없지.
- PO의 기획서에 있는 용어?
- 개발자가 그냥 만들어서 사용해야할까?
- PO와 대화를 통해서 해야할까? 개발자가 만들고 PO에게 confirm 받는 식이 되지 않을까? 
- '이 용어를 사용하겠습니다' 라고 공유하는게 뭔가 부끄럽긴한데...

우리가 볼 수 있는 유비쿼터스 언어는 어디에 있을까?
위키의 용어집: https://wiki.mm.meshkorea.net/pages/viewpage.action?pageId=18744032
전사 용어집: https://wiki.mm.meshkorea.net/pages/viewpage.action?pageId=33911543
   - 전사가 범위라는 측면에서 유비쿼터스 언어는 아니지 않을까?

용어용어집을 만들 때는 한글 언어와 그에 대응되는 영어가 있어야할까? -> 코드에 의미가 녹아들어야하는데, 코드는 영어니까...

라스트마일 용어집을 한번 갱신 만들어볼까? -> 유지가 중요한데...개발 프로세스에 넣어볼까?

배송에서 시작해볼까?
- 엇? 배송? 오더? 뭔가 맞을까? 우리는 뭘로 써야하지? 
```

실습 - 유비쿼터스 언어 만들어보기
