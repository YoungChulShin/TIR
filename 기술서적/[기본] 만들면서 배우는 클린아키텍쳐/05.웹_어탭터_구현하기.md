# 05. 웹 어댑터 구현하기
## 의존성 역전
![5-1](/Images/만들면서배우는클린아키텍쳐/5-1.jpg)

웹 어댑터가 유스케이스를 직접 호출도 가능한데, 왜 간접 계층이 있을까?
- 애플리케이션 코어가 외부 세계와 통신할 수 있는 곳에 대한 명세가 포트이기 때문이다
   - 포트를 통해서 외부와 어떤 통신이 일어나는지 알 수 있다
- 컨트롤러가 아니라 웹소켓을 구현한다고 한다고 생각해보면 웹 어댑터는 인커밍인 동시에 아웃고잉 어댑터가 될 수도 있기 때문이다. 

## 웹 어댑터의 책임
웹 어댑터의 역할
1. HTTP 요청을 자바 객체로 매핑
2. 권한 검사
3. 입력 유효성 검증
4. 입력을 유스케이스의 입력 모델로 매핑
5. 유스케이스 호출
6. 유스케이스 출력을 HTTP로 매핑
7. HTTP 응답을 반환

웹 어댑터에는 비지니스 로직이 들어가서는 안된다. 

웹 어댑터의 유효성 검증은 유스케이스 입력 모델의 유효성 책임과는 또 다른 검증이다. 
- 웹 어댑터의 입력 모델을 유스케이스의 입력 모델로 변환할 수 있다는 것을 검증해야한다

HTTP와 관련된 것들은 애플리케이션 계층으로 침투해서는 안된다. 
- 웹 어댑터를 먼저 개발하는 것이 아니라 유스케이스를 먼저 개발하면 경계를 흐리게 만드는 유혹에 빠지지 않을 수 있다

## 컨트롤러 나누기
컨트롤러는 몇개여야 할까?
- 너무 적은 것 보다는 너무 많은게 낫다. 클래스마다 코드도 적을 수록 좋다. 

컨트롤러를 각 연산에 대해서 별도의 패키지로 만들면, 각 컨트롤러 전용 모델을 package private으로 선언할 수 있다. 이를 통해서 다른 곳에서 재사용될 가능성을 없앤다. 

컨트롤러의 이름도 C,R,U,D를 사용하기전에 한번 더 숙고를 해보는게 좋다. CreateAccount 보다는 RegisterAccount가 더 좋아보이지 않는가?

## 유지보수 가능한 소프트웨어를 만드는데 어떤 도움이 될까?
__웹 어댑터를 구현할 때에는 HTTP 요청을 애플리케이션의 유스케이스에 대한 메서드 호출로 변환하고 결과를 다시 HTTP로 변환하고, 어떤 도메인 로직도 수행하지 않는 어댑터를 만들고 있다는 점을 염두해둬야한다.__

웹 컨트롤러를 나눌 때는 모델을 공유하지 않는 여러 작은 클래스들을 만드는 것을 두려워해서는 안된다. 

## 생각
나 역시 컨트롤러를 두루뭉실하게 만들어서 크게 키우는 면이 있는데 이 부분은 반성해야겠다. 


