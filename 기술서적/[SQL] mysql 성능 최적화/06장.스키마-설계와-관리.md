# 06. 스키마 설계와 관리
## 최적의 데이터 유형 선택
작을수록 좋다
- 데이터 유형이 작을수록 디스크, 메모리, cpu 캐시 공간을 덜 사용하기 때문에 대체로 더 빠르다.
- 하지만 데이터 유형의 범위를 늘리는것은 비싼 작업이기 때문에 데이터 유형을 잘 모르겠다면 초과하지 않을 것 같은 가장 작은 데이터 유형을 선택한다. 

단순할수록 좋다
- 예를들어 문자집합과 데이터 정렬은 정수를 이용해서 비교하는 것 보다 더 많은 연산이 사용된다. 
- 날짜의 경우 문자열 대신 mysql 의 기본 제공 유형을 사용하거나, ip 주소에 정수를 사용하는 것을 예로 들 수 있다. 

가급적 null을 피한다
- null을 저장할 의도가 아니라면 not null을 사용한다. 
- mysql은 인덱스, 인덱스 통계 및 값 비교를 복잡하게 만들기 때문에 null 가능 열을 참조하는 쿼리는 최적화 하기가 어렵다.
- null 가능 열을 인덱스로 만들면 더 많은 스토리지 공간을 사용한다.
   - 인덱스 내에서 null을 저장하고 관리하기 위한 포인터가 더 추가된다.
   - 인덱스 트리 내에서 정렬된 위치를 찾을 때 추가적인 비교 작업을 수행한다. 

특정 유형의 데이터를 선택할 때에는 그 속성을 잘 파악한다
- 예를들어서 datetime과 timestamp는 초 단위까지의 시간을 저장하는 것은 동일하지만 값의 범위나 데이터의 사이즈에서 차이가 난다. 

### 정수
signed와 unsigned의 동일한 스토리지 공간을 사용하고 성능에 차이가 없기 때문에 데이터 유형에 맞게 선택한다. 

### 문자열
varchar
- 필요한 만큼 공간을 사용하기 때문에 고정 길이보다 저장공간이 덜 사용될 수 있다.
- 길이 값 저장을 위한 추가 바이트 공간을 필요로한다. 
   - 열의 최대 길이가 255바이트 이하: 1바이트
   - 255 보다 크다면: 2바이트
- 행의 길이가 가변적이기 때문에 업데이트 할 때 행이 커질 수 있다. 
   - 예: innodb는 행을 맞추기 위해 페이지 분할을 해야할 수 있다. 

char
- 고정길이를 사용. 후행을 공백을 제거한다.

varchar와 char의 선택은 데이터 길이도 있지만 얼마나 변경이 자주 발생하느냐에도 있다.
- varchar는 데이터의 길이가 가변적이기 때문에 값 변경 이후에 데이터가 기존 사이즈를 넘어서면 아래 2개 중에 작업이 일어날 수 있다. 
   1. 레코드 자체를 다른 공간으로 옮기거나 (=row migration)
   2. 칼럼 값의 나머지 부분을 다른 공간에 저장 (=row chainging)







